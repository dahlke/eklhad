version: 2
jobs:
  test:
    docker:
      - image: eklhad/eklhad-web-circleci:0.1
    working_directory: /go/src/github.com/dahlke/eklhad/
    steps:
      - checkout
      - run: go get -v -t -d ./...
      - run: go test -v ./...
      - run: npm --prefix web/frontend/ install
      - run: npm --prefix web/frontend/ run-script test
workflows:
  version: 2
  test_and_deploy:
    jobs:
        - test